import{Contract as e}from"@bitcoin-computer/lib";class t extends e{constructor({voteMod:e,description:t}){super({voteMod:e,description:t})}async validVotes(){let e=new Set((await computer.getTXOs({mod:this.voteMod})).map(e=>e.split(":")[0])),t=new Set(e);for(let o of e){let s=new Set(await computer.db.wallet.restClient.getAncestors(o));s.delete(o),[...s].some(e.has,e)&&t.delete(o)}return Array.from(t)}async acceptingVotes(){let e=await this.validVotes();return[...(await Promise.all(e.map(e=>computer.sync(e)))).map(e=>e.res)].filter(e=>"accept"===e.vote&&e.electionId===this._id).reduce((e,t)=>e+t.tokensAmount,0n)}}class o extends e{constructor({electionId:e,tokens:t,vote:o}){super({electionId:e,tokensAmount:t.reduce((e,t)=>e+t.amount,0n),vote:o})}}export{t as Election,o as Vote};